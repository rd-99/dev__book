{"ast":null,"code":"import insertText from '../../utils/InsertTextAtPosition';\nimport { TextAreaTextApi } from '../../commands';\nimport { insertBeforeEachLine } from '../../commands/list';\n\n/**\n * - `13` - `Enter`\n * - `9` - `Tab`\n */\nfunction stopPropagation(e) {\n  e.stopPropagation();\n  e.preventDefault();\n}\nexport default (function (options, e) {\n  var target = e.target;\n  var starVal = target.value.substr(0, target.selectionStart);\n  var valArr = starVal.split('\\n');\n  var currentLineStr = valArr[valArr.length - 1];\n  var textArea = new TextAreaTextApi(target);\n  if (!options.tabSize) {\n    options.tabSize = 2;\n  }\n  /**\n   * `9` - `Tab`\n   */\n\n  if (e.keyCode === 9) {\n    stopPropagation(e);\n    var space = new Array(options.tabSize + 1).join(' ');\n    var val = space;\n    if (target.selectionStart !== target.selectionEnd) {\n      var _star = target.value.substring(0, target.selectionStart).split('\\n');\n      var _end = target.value.substring(0, target.selectionEnd).split('\\n');\n      var modifiedTextLine = [];\n      _end.forEach(function (item, idx) {\n        if (item !== _star[idx]) {\n          modifiedTextLine.push(item);\n        }\n      });\n      var modifiedText = modifiedTextLine.join('\\n');\n      var oldSelectText = target.value.substring(target.selectionStart, target.selectionEnd);\n      var newStarNum = target.value.substring(0, target.selectionStart).length;\n      textArea.setSelectionRange({\n        start: target.value.indexOf(modifiedText),\n        end: target.selectionEnd\n      });\n      var modifiedTextObj = insertBeforeEachLine(modifiedText, space);\n      textArea.replaceSelection(modifiedTextObj.modifiedText);\n      textArea.setSelectionRange({\n        start: newStarNum + options.tabSize,\n        end: newStarNum + oldSelectText.length + modifiedTextLine.length * options.tabSize\n      });\n    } else {\n      return insertText(target, val);\n    }\n  } else if (e.keyCode === 13 && /^-\\s/.test(currentLineStr)) {\n    /**\n     * `13` - `Enter`\n     */\n    stopPropagation(e);\n    return insertText(target, \"\\n- \");\n  }\n});","map":{"version":3,"names":["insertText","TextAreaTextApi","insertBeforeEachLine","stopPropagation","e","preventDefault","options","target","starVal","value","substr","selectionStart","valArr","split","currentLineStr","length","textArea","tabSize","keyCode","space","Array","join","val","selectionEnd","_star","substring","_end","modifiedTextLine","forEach","item","idx","push","modifiedText","oldSelectText","newStarNum","setSelectionRange","start","indexOf","end","modifiedTextObj","replaceSelection","test"],"sources":["../../../../src/components/TextArea/hotkeys.tsx"],"sourcesContent":["import insertText from '../../utils/InsertTextAtPosition';\nimport { TextAreaTextApi } from '../../commands';\nimport { insertBeforeEachLine } from '../../commands/list';\n\n\nexport interface IHotkeyOptions {\n  tabSize?: number;\n}\n\n/**\n * - `13` - `Enter`\n * - `9` - `Tab`\n */\nfunction stopPropagation(e: React.KeyboardEvent<HTMLTextAreaElement>) {\n  e.stopPropagation();\n  e.preventDefault();\n}\n\nexport default (options: IHotkeyOptions, e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n  const target = e.target as HTMLTextAreaElement;\n  const starVal = target.value.substr(0, target.selectionStart);\n  const valArr = starVal.split('\\n');\n  const currentLineStr = valArr[valArr.length - 1];\n  const textArea = new TextAreaTextApi(target);\n  if (!options.tabSize) {\n    options.tabSize = 2;\n  }\n  /**\n   * `9` - `Tab`\n   */\n  if (e.keyCode === 9) {\n    stopPropagation(e);\n    const space = new Array(options.tabSize + 1).join(' ');\n    let val = space;\n    if (target.selectionStart !== target.selectionEnd) {\n      const _star = target.value.substring(0, target.selectionStart).split('\\n');\n      const _end = target.value.substring(0, target.selectionEnd).split('\\n');\n      const modifiedTextLine: string[] = [];\n      _end.forEach((item, idx) => {\n        if (item !== _star[idx]) {\n          modifiedTextLine.push(item);\n        }\n      });\n      const modifiedText = modifiedTextLine.join('\\n');\n      const oldSelectText = target.value.substring(target.selectionStart, target.selectionEnd);\n      const newStarNum = target.value.substring(0, target.selectionStart).length;\n\n      textArea.setSelectionRange({\n        start: target.value.indexOf(modifiedText),\n        end: target.selectionEnd,\n      });\n\n      const modifiedTextObj = insertBeforeEachLine(modifiedText, space);\n      textArea.replaceSelection(modifiedTextObj.modifiedText);\n      textArea.setSelectionRange({\n        start: newStarNum + options.tabSize,\n        end: newStarNum + oldSelectText.length + (modifiedTextLine.length * options.tabSize),\n      });\n    } else {\n      return insertText(target, val);\n    }\n  } else if (e.keyCode === 13 && /^-\\s/.test(currentLineStr)) {\n    /**\n     * `13` - `Enter`\n     */\n    stopPropagation(e);\n    return insertText(target, `\\n- `);\n  }\n}"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,kCAAvB;AACA,SAASC,eAAT,QAAgC,gBAAhC;AACA,SAASC,oBAAT,QAAqC,qBAArC;;AAOA;AACA;AACA;AACA;AACA,SAASC,eAATA,CAAyBC,CAAzB,EAAsE;EACpEA,CAAC,CAACD,eAAF;EACAC,CAAC,CAACC,cAAF;AACD;AAED,gBAAe,UAACC,OAAD,EAA0BF,CAA1B,EAA0E;EACvF,IAAMG,MAAM,GAAGH,CAAC,CAACG,MAAjB;EACA,IAAMC,OAAO,GAAGD,MAAM,CAACE,KAAP,CAAaC,MAAb,CAAoB,CAApB,EAAuBH,MAAM,CAACI,cAA9B,CAAhB;EACA,IAAMC,MAAM,GAAGJ,OAAO,CAACK,KAAR,CAAc,IAAd,CAAf;EACA,IAAMC,cAAc,GAAGF,MAAM,CAACA,MAAM,CAACG,MAAP,GAAgB,CAAjB,CAA7B;EACA,IAAMC,QAAQ,GAAG,IAAIf,eAAJ,CAAoBM,MAApB,CAAjB;EACA,IAAI,CAACD,OAAO,CAACW,OAAb,EAAsB;IACpBX,OAAO,CAACW,OAAR,GAAkB,CAAlB;EACD;EACD;AACF;AACA;;EACE,IAAIb,CAAC,CAACc,OAAF,KAAc,CAAlB,EAAqB;IACnBf,eAAe,CAACC,CAAD,CAAf;IACA,IAAMe,KAAK,GAAG,IAAIC,KAAJ,CAAUd,OAAO,CAACW,OAAR,GAAkB,CAA5B,EAA+BI,IAA/B,CAAoC,GAApC,CAAd;IACA,IAAIC,GAAG,GAAGH,KAAV;IACA,IAAIZ,MAAM,CAACI,cAAP,KAA0BJ,MAAM,CAACgB,YAArC,EAAmD;MACjD,IAAMC,KAAK,GAAGjB,MAAM,CAACE,KAAP,CAAagB,SAAb,CAAuB,CAAvB,EAA0BlB,MAAM,CAACI,cAAjC,EAAiDE,KAAjD,CAAuD,IAAvD,CAAd;MACA,IAAMa,IAAI,GAAGnB,MAAM,CAACE,KAAP,CAAagB,SAAb,CAAuB,CAAvB,EAA0BlB,MAAM,CAACgB,YAAjC,EAA+CV,KAA/C,CAAqD,IAArD,CAAb;MACA,IAAMc,gBAA0B,GAAG,EAAnC;MACAD,IAAI,CAACE,OAAL,CAAa,UAACC,IAAD,EAAOC,GAAP,EAAe;QAC1B,IAAID,IAAI,KAAKL,KAAK,CAACM,GAAD,CAAlB,EAAyB;UACvBH,gBAAgB,CAACI,IAAjB,CAAsBF,IAAtB;QACD;MACF,CAJD;MAKA,IAAMG,YAAY,GAAGL,gBAAgB,CAACN,IAAjB,CAAsB,IAAtB,CAArB;MACA,IAAMY,aAAa,GAAG1B,MAAM,CAACE,KAAP,CAAagB,SAAb,CAAuBlB,MAAM,CAACI,cAA9B,EAA8CJ,MAAM,CAACgB,YAArD,CAAtB;MACA,IAAMW,UAAU,GAAG3B,MAAM,CAACE,KAAP,CAAagB,SAAb,CAAuB,CAAvB,EAA0BlB,MAAM,CAACI,cAAjC,EAAiDI,MAApE;MAEAC,QAAQ,CAACmB,iBAAT,CAA2B;QACzBC,KAAK,EAAE7B,MAAM,CAACE,KAAP,CAAa4B,OAAb,CAAqBL,YAArB,CADkB;QAEzBM,GAAG,EAAE/B,MAAM,CAACgB;MAFa,CAA3B;MAKA,IAAMgB,eAAe,GAAGrC,oBAAoB,CAAC8B,YAAD,EAAeb,KAAf,CAA5C;MACAH,QAAQ,CAACwB,gBAAT,CAA0BD,eAAe,CAACP,YAA1C;MACAhB,QAAQ,CAACmB,iBAAT,CAA2B;QACzBC,KAAK,EAAEF,UAAU,GAAG5B,OAAO,CAACW,OADH;QAEzBqB,GAAG,EAAEJ,UAAU,GAAGD,aAAa,CAAClB,MAA3B,GAAqCY,gBAAgB,CAACZ,MAAjB,GAA0BT,OAAO,CAACW;MAFnD,CAA3B;IAID,CAxBD,MAwBO;MACL,OAAOjB,UAAU,CAACO,MAAD,EAASe,GAAT,CAAjB;IACD;EACF,CA/BD,MA+BO,IAAIlB,CAAC,CAACc,OAAF,KAAc,EAAd,IAAoB,OAAOuB,IAAP,CAAY3B,cAAZ,CAAxB,EAAqD;IAC1D;AACJ;AACA;IACIX,eAAe,CAACC,CAAD,CAAf;IACA,OAAOJ,UAAU,CAACO,MAAD,SAAjB;EACD;AACF,CAlDD"},"metadata":{},"sourceType":"module"}