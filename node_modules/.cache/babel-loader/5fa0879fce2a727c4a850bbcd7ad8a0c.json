{"ast":null,"code":"import * as esbuild from 'esbuild-wasm';\nimport { unpkgPathPlugin } from './plugins/unpkg-path-plugin';\nimport { fetchPlugin } from './plugins/fetch-plugin';\nlet service;\nconst bundle = async rawCode => {\n  if (!service) {\n    service = await esbuild.startService({\n      worker: true,\n      wasmURL: 'https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm'\n    });\n  }\n  ;\n  try {\n    const result = await service.build({\n      entryPoints: ['index.js'],\n      bundle: true,\n      write: false,\n      plugins: [unpkgPathPlugin(), fetchPlugin(rawCode)],\n      define: {\n        'process.env.NODE_ENV': '\"production\"',\n        global: 'window'\n      }\n    });\n\n    //console.log(result);\n    return {\n      code: result.outputFiles[0].text,\n      err: ''\n    };\n  } catch (err) {\n    return {\n      code: '',\n      err: err.message\n    };\n  }\n};\nexport default bundle;","map":{"version":3,"names":["esbuild","unpkgPathPlugin","fetchPlugin","service","bundle","rawCode","startService","worker","wasmURL","result","build","entryPoints","write","plugins","define","global","code","outputFiles","text","err","message"],"sources":["C:/Users/Acer/Desktop/dev__book/dev__book/src/bundler/index.ts"],"sourcesContent":["import * as esbuild from 'esbuild-wasm';\r\nimport { unpkgPathPlugin } from './plugins/unpkg-path-plugin';\r\nimport { fetchPlugin } from './plugins/fetch-plugin';\r\n\r\nlet service: esbuild.Service;\r\n\r\nconst bundle =  async (rawCode : string) => {\r\n    \r\n    if (!service){\r\n        service = await esbuild.startService({\r\n        worker: true,\r\n        wasmURL: 'https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm',\r\n      });\r\n    };\r\n    \r\n    try {\r\n        const result = await service.build({\r\n            entryPoints: ['index.js'],\r\n            bundle: true,\r\n            write: false,\r\n            plugins: [unpkgPathPlugin(), fetchPlugin(rawCode)],\r\n            define: {\r\n              'process.env.NODE_ENV': '\"production\"',\r\n              global: 'window',\r\n            },\r\n          });\r\n      \r\n           //console.log(result);\r\n           return {\r\n            code : result.outputFiles[0].text,\r\n            err: ''   \r\n           }\r\n        \r\n    } catch (err:any) {\r\n        \r\n            return {\r\n                code: '',\r\n                err: err.message,\r\n            }\r\n        \r\n        \r\n    }\r\n    \r\n    };\r\n    \r\nexport default bundle;\r\n\r\n\r\n"],"mappings":"AAAA,OAAO,KAAKA,OAAO,MAAM,cAAc;AACvC,SAASC,eAAe,QAAQ,6BAA6B;AAC7D,SAASC,WAAW,QAAQ,wBAAwB;AAEpD,IAAIC,OAAwB;AAE5B,MAAMC,MAAM,GAAI,MAAOC,OAAgB,IAAK;EAExC,IAAI,CAACF,OAAO,EAAC;IACTA,OAAO,GAAG,MAAMH,OAAO,CAACM,YAAY,CAAC;MACrCC,MAAM,EAAE,IAAI;MACZC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ;EAAC;EAED,IAAI;IACA,MAAMC,MAAM,GAAG,MAAMN,OAAO,CAACO,KAAK,CAAC;MAC/BC,WAAW,EAAE,CAAC,UAAU,CAAC;MACzBP,MAAM,EAAE,IAAI;MACZQ,KAAK,EAAE,KAAK;MACZC,OAAO,EAAE,CAACZ,eAAe,CAAC,CAAC,EAAEC,WAAW,CAACG,OAAO,CAAC,CAAC;MAClDS,MAAM,EAAE;QACN,sBAAsB,EAAE,cAAc;QACtCC,MAAM,EAAE;MACV;IACF,CAAC,CAAC;;IAED;IACA,OAAO;MACNC,IAAI,EAAGP,MAAM,CAACQ,WAAW,CAAC,CAAC,CAAC,CAACC,IAAI;MACjCC,GAAG,EAAE;IACN,CAAC;EAER,CAAC,CAAC,OAAOA,GAAO,EAAE;IAEV,OAAO;MACHH,IAAI,EAAE,EAAE;MACRG,GAAG,EAAEA,GAAG,CAACC;IACb,CAAC;EAGT;AAEA,CAAC;AAEL,eAAehB,MAAM"},"metadata":{},"sourceType":"module"}